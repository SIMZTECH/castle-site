import{r as l,l as v}from"./app-D5o-_rBG.js";import{a as Y}from"./UserAuthenticationContext-DYQ2QGHb.js";import{s as V}from"./DataStoreTemp-k18OiJTD.js";function $(){var S;const{setLiveGames:b,setTempSwarmData:D,setGetBoostedGames:_,setGetSingleGame:j,setTodayGames:O,setGetGamesByCompetition:h,placeBetResponse:X,setPlaceBetResponse:y,setGetPaymentResponse:R}=l.useContext(V),{authUser:f,dispatch:m}=l.useContext(Y),[T,C]=l.useState(!1),[M,B]=l.useState(null),[P,E]=l.useState(null),[x,G]=l.useState(null),[L,Z]=l.useState(null),[F,U]=l.useState(null),[J,H]=l.useState(1),[I,W]=l.useState(null),[q,K]=l.useState(null),u=l.useRef(null);l.useEffect(()=>{const a=new WebSocket("wss://eu-swarm-test.betconstruct.com/");u.current=a,a.onopen=()=>{H(J+1),setTimeout(()=>{C(!0)},2500)},a.onmessage=i=>{var z,Q;const{data:e,rid:c}=JSON.parse(i==null?void 0:i.data);if(c=="1")e!=null&&e.sid&&(E(e),v.isNil(f==null?void 0:f.auth_token)?(w(),k(),d()):s(f));else if(c=="2")e!=null&&e.auth_token?N():(G(e),console.log(e,"i have reported to the call login error......"));else if(c=="4")e.auth_token&&(t(e),G(e),n());else if(c=="13")(z=e==null?void 0:e.data)!=null&&z.sport&&(B(e),D(e));else if(c=="5")(e==null?void 0:e.result)=="OK"?(N(),console.log(e,"am reporting to the caller the place bet success"),y(e)):(y(e),console.log(e,"am reporting to the caller the place bet errors"));else if(c=="7")if(e!=null&&e.auth_token){w(),k(),d(),N(),console.log(e,"here is the restored user login data.....");return}else console.log(e,"rejected restore session"),A(),w(),k(),d();else if(c=="8")v.isNil(e)?(console.log(e,"recieved logout response...."),m({type:"AUTHUSERUNLOGGED"}),U({data:e,rid:c})):(console.log(e,"i have passed the logout res to caller"),U({data:e,rid:c}));else if(c=="9"){if(e){const g={...JSON.parse(localStorage.getItem("authUser"))};g.bet_history=e,t(g),o(),p();return}}else if(c=="10")(Q=e==null?void 0:e.data)!=null&&Q.profile;else if(c=="11")W(e),console.log(e,"user registration data res.....");else if(c=="12")K(e),console.log(e,"cashout data has been recieved in socket....");else if(c=="14")e&&b(e==null?void 0:e.data),console.log(e,"live games are here sir......");else if(c=="15")_(e==null?void 0:e.data),console.log(e,"boosted games are here........");else if(c=="16")h(e==null?void 0:e.data),console.log(e,"games by competition are here........");else if(c=="17")O(e==null?void 0:e.data),console.log(e,"today games are here........");else if(c=="18")j(e),console.log(e,"sing game details are........");else if(c=="19"){if(console.log(e,"transaction data history is here........"),e){const g={...JSON.parse(localStorage.getItem("authUser"))};g.transaction_history=e,t(g)}}else if(c=="20"){if(console.log(e,"payment services data are here........"),e){const g={...JSON.parse(localStorage.getItem("authUser"))};g.payment_services=e,t(g)}}else c=="21"&&(R(e),console.log(e,"deposit response data is here......"))},a.onerror=i=>{console.log("socket error......",i)}},[]);const A=()=>{m({type:"AUTHUSERUNLOGGED"}),console.log("i have cleared prev user")},k=()=>{const a={command:"get",params:{source:"betting",what:{sport:["alias"],region:["id","alias"],competition:["id","name"],game:["info","id","team1_name","team2_name","start_ts","markets_count","strong_team","type","live_events"],market:["name","type","market_type"],event:[]},where:{sport:{alias:"Soccer"},market:{market_type:{"@in":["MatchResult"]}},game:{type:1}},subscribe:!0},rid:"14"};console.log(a,"i have requested for live games....."),u.current.send(JSON.stringify(a))},d=()=>{const a={command:"get",params:{source:"betting",what:{sport:["alias"],region:["id","alias"],competition:["id","name","favorite","favorite_order"],game:["id","team1_name","team2_name","start_ts","markets_count","strong_team","type"],market:["name","type","market_type"],event:[]},where:{sport:{alias:"Soccer"},market:{market_type:{"@in":["MatchResult"]}},competition:{favorite:!0}}},rid:"15"};console.log(a,"i have requested for boosted games....."),u.current.send(JSON.stringify(a))},w=()=>{const a={command:"get",params:{source:"betting",what:{sport:["alias"],region:["id","alias"],competition:["id","name","alias","favorite","favorite_order"],game:["id","team1_id","team2_id","team1_name","team2_name","start_ts","markets_count","market","strong_team","add_info_name","market"],market:["name","type","market_type"],event:[]},where:{sport:{alias:"Soccer"},market:{market_type:{"@in":["DoubleChance","MatchResult","OverUnder"]}}},subscribe:!1},rid:"13"};u.current.send(JSON.stringify(a)),console.log("i have requested all the games.....")},N=a=>{const i={command:"get_user",params:{},rid:"4"};u.current.send(JSON.stringify(i))},t=a=>{console.log(a,"authenticated user stored in store...."),m({type:"AUTHUSERLOGGED",payload:{authUser:a}})},s=a=>{const i={command:"restore_login",params:{user_id:Number(a==null?void 0:a.user_id),auth_token:a==null?void 0:a.auth_token},rid:"7"};console.log(i,"i have requested to re-store login......."),u.current.send(JSON.stringify(i))},r=new Date().getTime(),n=a=>{const i={command:"bet_history",params:{where:{from_date:Math.floor(r/1e3)-604800,to_date:r}},rid:"9"};console.log(i,"i have requested for bet history for this user......."),u.current.send(JSON.stringify(i))},o=a=>{const i=new Date().getTime(),e={command:"balance_history",params:{where:{from_date:Math.floor(i/1e3)-7*24*60*60,to_date:i},product:"Sport"},rid:"19"};console.log(e,"i have requested transaction history......."),u.current.send(JSON.stringify(e))},p=a=>{const i={command:"payment_services",params:{detailed:!0},rid:"20"};console.log(i,"i have requested payments wallets......."),u.current.send(JSON.stringify(i))};return[T,M,(S=u.current)==null?void 0:S.send.bind(u.current),P,x,L,F,I,q]}function oe(){const{getCompAndRegParams:b,setGetGamesByCompetition:D,placeBetReqParams:_,setPlaceBetReqParams:j,liveGamesUpdateKey:O,getGameDetailsParams:h,singleLiveGamesUpdateKey:X,getDepositParams:y}=l.useContext(V),[R,f,m,T,C,M,B,P,E]=$();function x(t=20001,s=1,r="Soccer",n=566,o="P1XP2"){const p={command:"get",params:{source:"betting",what:{sport:["id","name","type","region"],region:["competition","name"],competition:["id","game","name","game"],game:["id","team1_id","team2_id","team1_name","team2_name","start_ts","markets_count","event","market","strong_team","add_info_name"],market:["event","type"],event:["id","name","price"]},where:{sport:{alias:r},region:{id:t},competition:{id:n},market:{type:{"@in":[o]}}},subscribe:!1},rid:"13"};console.log({params:p}),m(JSON.stringify(p))}function G(){m(JSON.stringify({command:"request_session",params:{site_id:65,language:"eng"},rid:"1"})),console.log("i have requested the session......socket:"+R)}const L=()=>{m(JSON.stringify({command:"get",params:{source:"betting",what:{sport:["alias"],region:["id","alias","order"],competition:["id","name","favorite_order"],game:["id","team1_id","team2_id","team1_name","team2_name","start_ts","markets_count","market","strong_team","info","add_info_name","market"],market:["name","type","market_type"],event:[]},where:{sport:{alias:"Soccer"},market:{market_type:{"@in":["DoubleChance","MatchResult","OverUnder"]}}},subscribe:!1},rid:"13"})),console.log("i have requested all the games.....")};function Z(t){const{sport_alias:s,region_alias_collection:r,time_stamp_custom:n}=t,o={command:"get",params:{source:"betting",what:{sport:["alias"],region:["alias"],competition:["name"],game:["id","team1_id","team2_id","team1_name","team2_name","start_ts","markets_count","strong_team","add_info_name"],market:["name"],event:["id","name","price"]},where:{sport:{alias:s},region:{alias:{"@in":r}},game:{start_ts:{"@now":{"@lte":n}}},market:{type:{"@in":["P1XP2"]}}},subscribe:!1}};console.log({params:o}),m(JSON.stringify(o))}const F=t=>{const{username:s,password:r}=t,n={command:"login",params:{username:s,password:r},rid:"2"};console.log(n,"i have sent the login request......"),m(JSON.stringify(n))},U=t=>{const{phone:s,password:r,email:n,username:o,first_name:p,last_name:S,currency:a}=t,i={command:"register_user",params:{user_info:{username:o,password:r,currency_name:"ZMW",lang_code:"arm",country_code:"ZM",email:"calrogerscal@gmail.com"}},rid:"11"};m(JSON.stringify(i)),console.log(i,"i have sent the register request")},J=(t,s)=>{const r=[];s.map(o=>{r.push({event_id:o==null?void 0:o.event_id,price:o==null?void 0:o.market_price})});const n={command:"do_bet",params:{type:r.length>1?2:1,mode:0,amount:t,odd_type:0,bets:r},rid:"5"};m(JSON.stringify(n)),console.log(n,"am about to send request sir....")},H=t=>{const s={command:"secure_logout",params:{jwe_token:t==null?void 0:t.auth_token},rid:"8"};m(JSON.stringify(s)),console.log(s,"logout request.....")},I=t=>{const{bet_id:s,price:r,mode:n}=t,o={command:"cashout",params:{bet_id:s,price:r,mode:1},rid:"12"};m(JSON.stringify(o)),console.log(o,"i have requested for cashout.....")},W=t=>{const s={command:"bet_history",params:{where:{}},rid:"9"};console.log(s,"i have requested for bet history for this user......."),m(JSON.stringify(s))},q=()=>{const t={command:"get",params:{source:"betting",what:{sport:["alias"],region:["id","alias"],competition:["id","name"],game:["info","id","team1_name","team2_name","start_ts","markets_count","strong_team","type","live_events"],market:["name","type","market_type"],event:[]},where:{sport:{alias:"Soccer"},market:{market_type:{"@in":["MatchResult"]}},game:{type:1}}},rid:"14"};console.log(t,"i have requested for live games....."),m(JSON.stringify(t))},K=()=>{m(JSON.stringify({command:"whats_up",rid:"14"})),console.log("i have requested for an update.....")},u=t=>{const{game_id:s,region_id:r,competition_id:n}=t,o={command:"get",params:{source:"betting",what:{game:["info","id","team1_name","team2_name","start_ts","markets_count","strong_team","type","live_events"],market:[],event:[]},where:{competition:{id:n},region:{id:r},game:{id:s},market:{}}},rid:"18"};console.log(t,"i have requested for single game details of game_id"+s),m(JSON.stringify(o))},A=()=>{const t={command:"get",params:{source:"betting",what:{sport:["alias"],region:["id","alias"],competition:["id","name","favorite","favorite_order"],game:["id","team1_name","team2_name","start_ts","markets_count","strong_team","type"],market:["name","type","market_type"],event:[]},where:{sport:{alias:"Soccer"},market:{market_type:{"@in":["MatchResult"]}},competition:{favorite:!0}}},rid:"15"};console.log(t,"i have requested for boosted games....."),m(JSON.stringify(t))},k=()=>{const r=new Date().getTime().toString().substring(0,5).concat(38399),n=Number(r),o={command:"get",params:{source:"betting",what:{sport:["alias"],region:["id","alias"],competition:["id","name","favorite","favorite_order"],game:["id","team1_name","team2_name","start_ts","markets_count","strong_team","type"],market:["name","type","market_type"],event:[]},where:{sport:{alias:"Soccer"},market:{market_type:{"@in":["MatchResult"]}},game:{start_ts:{"@gt":0,"@lte":n}}}},rid:"17"};console.log(o,"i have requested for games of today....."),m(JSON.stringify(o))},d=t=>{const{compt_id:s,reg_id:r,sport_id:n}=t,o={command:"get",params:{source:"betting",what:{sport:["alias"],region:["id","alias"],competition:["id","name"],game:["id","team1_name","team2_name","start_ts","markets_count","strong_team","type","order"],market:["name","type","market_type"],event:[]},where:{sport:{alias:"Soccer"},region:{id:r},market:{market_type:{"@in":["MatchResult"]}},competition:{id:s}}},rid:"16"};console.log(o,"i have requested for single competition of reg id"+(t==null?void 0:t.reg_id)),m(JSON.stringify(o))},w=t=>{const{compt_id:s,reg_id:r,sport_id:n}=t;switch(t==null?void 0:t.identifier){case 1:{q();break}case 2:{A();break}case 3:{k();break}default:{d({compt_id:s,reg_id:r,sport_id:n});break}}},N=t=>{const{amount:s,currency:r,service:n,customer_id:o,customer_password:p}=t,S={command:"deposit",params:{amount:s,currency:r,service:n,payer:{customer_id:o,customer_password:p}},rid:"21"};console.log(S,"i have sent a deposit request to"+n),m(JSON.stringify(S))};return l.useMemo(()=>{v.isNil(b)||(D(null),setTimeout(()=>{d(b)},100))},[b]),l.useMemo(()=>{v.isNil(h)||u(h),console.log(h,"am executing the testing update....")},[h,X]),l.useMemo(()=>{if(!v.isNil(_)){const{stakeAmount:t,bets:s}=_;J(t,s),console.log(_,"i have invocked the use memo hook to place bet......")}},[_]),l.useMemo(()=>{O>0&&q()},[O]),l.useMemo(()=>{if(!v.isNil(y)){N(y);return}},[y]),{isReady:R,swarmData:f,authData:T,placeBetRequest:J,writeSessionData:G,getAllGamesForWelcome:x,getUpcomingGamesByTime:Z,getAllFootballGamesCollection:L,loginUserFirstTime:F,userAuth:C,placeBetRes:M,logoutUser:H,logoutRes:B,registerUser:U,registerRes:P,requestCashout:I,getAuthUserBetHistory:W,getFilteredGamesCollection:w,cashOutRes:E,getUpdatesWhatsUp:K,getAllLiveGames:q,getSingleGameDetails:u,getBoostedGames:A,getTodayGamesByTimeStamp:k,getGameByRegionAndCompetition:d}}export{oe as F};
